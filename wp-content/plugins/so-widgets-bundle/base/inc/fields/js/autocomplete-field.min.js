!function(e){e(document).on("sowsetupformfield",".siteorigin-widget-field-type-autocomplete",(function(t){var i=e(this),n=i.find(" .existing-content-selector");if(i.data("initialized"))return;var s=function(){var e=i.find("input.siteorigin-widget-input").val();return 0===e.length?[]:e.split(",")},a=function(){var t=s();i.find("ul.items > li").each((function(i,n){var s=e(this);t.indexOf(s.data("value"))>-1?s.addClass("selected"):s.removeClass("selected")}))};const l=i.find("ul.items"),d=i.find(".content-no-results");const o=()=>{const t=i.find(".content-text-search"),n=t.val(),s=t.data("source"),a=t.data("postTypes"),o={action:"so_widgets_search_"+s};return"posts"===s?(o.query=n,o.postTypes=a):"terms"===s&&(o.term=n),"string"==typeof icl_this_lang&&(o.language=icl_this_lang),d.addClass("hidden"),l.empty(),l.removeClass("hidden"),l.addClass("loading"),e.get(soWidgets.ajaxurl,o,t=>{if(0===t.length)return d.removeClass("hidden"),l.addClass("hidden"),void l.removeClass("loading");t.forEach(t=>{""===t.label&&(t.label="&nbsp;"),l.append(e("<li>").html(t.label+"<span>("+t.type+")</span>").data(t))}),l.removeClass("loading")})};i.find(".siteorigin-widget-autocomplete-input").on("click",()=>{d.addClass("hidden"),l.show(),n.show();let t=new e.Deferred;n.is(":visible")&&0===n.find("ul.items li").length?t=o():t.resolve(),t.done(a)});var r=function(){n.hide()};e(window).on("mousedown",(function(e){0===i.find(e.target).length&&r()})),i.find(".button-close").on("click",r),i.on("click keypress",".items li",(function(t){if(t.preventDefault(),"keyup"!=t.type||window.sowbForms.isEnter(t)){var a=i.find("input.siteorigin-widget-input"),l=e(this),d=l.data("value");if(n.data("multiple")){var o=s(),c=o.indexOf(d);c>-1?(o.splice(c,1),l.removeClass("selected")):(o.push(d),l.addClass("selected")),a.val(o.join(","))}else l.parent().find(".selected").removeClass("selected"),l.addClass("selected"),a.val(d),r();a.trigger("change")}}));var c=null;i.find(".content-text-search").on("keyup",(function(){null!==c&&clearTimeout(c),c=setTimeout((function(){o()}),500)})),i.data("initialized",!0)}))}(jQuery);